import json
from Bio import SeqIO
from Bio.Seq import Seq
from Bio import pairwise2
import boto3
import uuid

s3_client = boto3.client('s3')


def lambda_handler(event, context):
    for record in event['Records']:
        bucket = record['s3']['bucket']['name']
        key = record['s3']['object']['key']
        gene = key.split("--")[1]
        up = key.rsplit(".", 1)[0] + '.txt'
        download_path = '/tmp/{}{}'.format(uuid.uuid4(), key)
        upload_path = '/tmp/txtformat-{}'.format(up)
        s3_client.download_file(bucket, key, download_path)
        seq_conversion(download_path, upload_path, gene)
        s3_client.upload_file(upload_path, bucket, up)


def seq_conversion(download_path, upload_path, gene):
    # TODO: check file extension and handle
    record = SeqIO.read(download_path, "abi")
    # create cat file and result file with maft
    if (gene == 'cmvphos'):
        gene = 'ATGTCCTCCGCACTTCGGTCTCGGGCTCGCTCGGCCTCGCTCGGAACGACGACTCAGGGCTGGGATCCGCCGCCATTGCGTCGTCCCAGCAGGGCGCGCCGGCGCCAGTGGATGCGCGAAGCTGCGCAGGCCGCCGCTCAAGCCGCGGTACAGGCCGCGCAGGCCGCCGCCGCTCAAGTTGCCCAGGCTCACGTCGATGAAGACGAGGTCGTGGATCTGATGACCGACGAGGCCGGCGGCGGCGTCACCACTTTGACCACCCTGAGTTCCGTCAGCACAACCACCGTGCTTGGACACGCGACTTTTTCCGCATGCGTTCGAAGTGACGTGATGCGTGACGGAGAAAAAGAGGACGCGGCTTCGGACAAGGAGAACCAGCGTCGGCCCGTGGTGCCGTCCACGTCGTCTCGCGGCAGCGCCGCCAGCGGCGACGGTTACCACGGCTTGCGCTGCCGCGAAACCTCGGCCATGTGGTCGTTCGAGTACGATCGCGACGGCGACGTGACCAGCGTACGCCGCGCTCTCTTCACCGGCGGCAGCGACCCCTCGGACAGCGTGAGCGGCGTCCGCGGTGGACGCAAACGCCCGTTGCGTCCGCCGTTGGTGTCGCTGGCCCGCACCCCGCTGTGCCGACGTCGTGTGGGCGGCGTGGACGCGGTGCTCGAAGAAAACGACGTGGAGCTGCGCGCGGAAAGTCAGGACAGCGCCGTGGCATCGGGCCCGGGCCGCGTTCCGCAGCCGCTCAGCGGTAGTTCCGGGGAGGAATCCGCCACGGCGGTGGAGGCCGACTCCACGTCACACGACGACGTGCATTGCACCTGTTCCAACGACCAGATCATCACCACGTCCATCCGCGGCCTTACGTGCGACCCGCGTATGTTCTTGCGCCTTACGCATCCCGAGCTCTGCGAGCTCTCTATCTCCTACCTGCTGGTCTACGTGCCCAAAGAGGACGATTTTTGCCACAAGATCTGTTATGCCGTGGACATGAGCGACGAGAGCTACCGCCTGGGCCAGGGCTCCTTCGGCGAGGTCTGGCCGCTCGATCGCTATCGCGTGGTCAAGGTGGCGCGTAAGCACAGCGAGACGGTGCTCACGGTCTGGATGTCGGGCCTGATCCGCACGCGCGCCGCTGGCGAGCAACAGCAGCCGCCGTCGCTGGTGGGCACGGGCGTGCACCGCGGTCTGCTCACGGCCACGGGCTGCTGTCTGCTGCACAACGTCACGGTACATCGACGTTTCCACACAGACATGTTTCATCACGACCAGTGGAAGCTGGCGTGCATCGACAGCTACCGACGTGCCTTTTGCACGTTGGCCGACGCTATCAAATTTCTCAATCACCAGTGTCGTGTATGCCACTTTGATATTACACCCATGAACGTGCTCATCGACGTGAACCCGCACAACCCCAGCGAGATCGTGCGCGCCGCGCTGTGCGATTACAGCCTCAGCGAGCCCTATCCGGATTACAACGAGCGCTGTGTGGCCGTCTTTCAGGAGACGGGCACGGCGCGCCGCATCCCCAACTGCTCGCACCGTCTGCGCGAATGTTACCACCCTGCTTTCCGACCCATGCCGCTGCAGAAGCTGCTCATCTGCGACCCGCACGCGCGTTTCCCCGTAGCCGGCCTACGGCGTTATTGCATGTCGGAGTTGTCGGCGCTGGGTAACGTGCTGGGCTTTTGCCTCATGCGGCTGTTGGACCGGCGCGGTCTGGACGAGGTGCGCATGGGTACGGAGGCGTTGCTCTTTAAGCACGCCGGCGCGGCCTGCCGCGCGTTGGAGAACGGCAAGCTCACGCACTGCTCCGACGCCTGTCTGCTCATTCTGGCGGCGCAAATGAGCTACGGCGCCTGTCTCCTGGGCGAGCATGGCGCCGCGCTGGTGTCGCACACGCTACGCTTTGTGGAGGCCAAGATGTCCTCGTGTCGCGTACGCGCCTTTCGCCGCTTCTACCACGAATGCTCGCAGACCATGCTGCACGAATACGTCAGAAAGAACGTGGAGCGTCTGTTGGCCACGAGCGACGGGCTGTATTTATATAACGCCTTTCGGCGCACCACCAGCATAATCTGCGAGGAGGACCTTGACGGTGACTGCCGTCAACTGTTCCCCGAGTAA'
    elif (gene == 'cmvterm'):
        gene = 'TTAACGCAGACTACCAGGCACCAGATCCTGGATTCCATGTTCGTCGCGGGCCAAATCCAGCAGCGATGAGGCGCGTCGTGGTCTCTTGCGTGTTGCGCGGACCCTCCGGGAAACGCCCGCGGTCGAGGAGGAGGGGTACGGACTTGGCAGCCAAGGTCGGTCCGGCTCCCTGAAGGCACCCGAGACGGCCGCGGCGGCCGTCAGGGTGGAGGGCTTGGCCACGGGAGCTGTTGGCACGTCGCCACTCTCATCCGGTCTGGACAGATGCCTGTAGAGGAGGAGATATAGATCTTTGGACTTATAAAGACTTCCTTCGTGACGAAGCAGCAGCGGCCACTCTTTGTTATACGTGAGAATCACATCTCTGTCCGGGTGCAGTTCGTCGCGCAGGCACGCGATCGAGAGTTGTTTCCCGAAAGTTTCATTATATAGTGCGACGGAGAGCACGAGCTCCCGCACGTGCATCCACATCTCCTTCTGCAGCACGTTTAGGTCCTGACAGTCCGAAAAATTGAAAAAACCCATGTACTTCACCACCATCCACTCACTGGGATACACGGTACCTTCCGCGCATTTGACCAAATCGTCCTTGACGTGGGGTAGTACGCCCGCGTTGTCGCAGGCATAGGCCATGTCCACATTGTGAGAGAGGGGATAGCGATCGGTACAGTGTGTGAAGAGGGGCCCGTTACACAACTCGTAGATCTGCTGACCCAGTAGCGGGAGGGATTCCACAGGCAGACTCTTGTGGATCAGGTTATTGACCACATACAGGTGCTCATCGTACGTGAACTGATTCCCCACGTCCACCACGTCTTGGTCCTGGTGGTATTGGCTGCGGTATAGAAACCCATTCATGAGCTTAGAGATAAAGTCCAGACACAAGGGCCCCACTAGGTTGACATCGATGAGTTTGCTAGTCAGACGCTCCTGCGTTTTGATGCAACGGATCACCTTGCCATAGCCCACCTCCGAGACCTTCTGCAGGTAGGCGCGTTTGCGCACGTTCACCTCGCGGGTGACGTTGTGGATGCGGGAACGCGCGTCCACCAAGTCGAGAGCTTCGTGTTCGTCGCAGTTGCGCACCCGTAAGCCGTTTTCGCTGCCGTCGCCGTCCTGCCCATTCGCCCCTCCCCCTACAGCTTTCTTGCCTCCTCCACGGGCCCGGCCGCCGCCACCGTTATTCCTCTGACTGTGAGTACTGCTGTTGCTGCTGTTGCTGGCCGTCATCAAAGTCGTACCCGTCCCCGACATCGCCTCCCGTCCACGCAGGTGAATAACCTCGCCCTCGGGGCCGTCGCCCCCCGTGCCATCGGGCAGCGGACGTCGAATCTCCTCGAGAATATGCTTGATTTTGGTGTACATCTCGTTGCTTTCGTGGAGCTTGTTGAACACCGGGTTGTCCTCGAAAGCTTGAATGCTGAGGGATGTGATGAGGTCGATGATCCTGTTGGGGGCGGCAAAGACCGACCCCACGAACATGCGCTCCTCCCCGTCCAACGCCTTTTCCCCGAGCACGAAGATGTCCTCCACGTCCTCCCCGTACAGATGGCGACTGATGCCGTTCATGAGCGCCCGGCACAGCTGGTGATACACATTTAGCTGCTGGATGGTGATGCCCACCCGCTTGACGATAACCTCCGAGGTACGGGACCAGTAGGTAAAATCCGACAAGGAATATATTCGTTCCGGTATATCCGTAAACAGGTTGTACTCCCTCAGCGCCTCCTCCGCCTCCTGGATGTAGCTGTGGTAGGCCGATGAAGAAGAGAATAGGCTTTTGAGGGCCGAAAGGACTCCAGCCAAGTGGGGGATGCGCGTTGTCAGGTCCAGCAGGTCCTGCTCCACCGTCTGGATATTCACATCGGACTGGCTTGACGGACGGTGGACCGCTATATGGTTGCACAGCAAGCCCTGCAGCCGCTTGTTCAGCGAGCGGCCCTGATTCGGGATGATGGTCAGCTCCTCGTAGCATTGGGCGCATGTCGTCCCTTCGACGTACACTTCCTGACGCGCCACCGGCGAGATGCCGCATAGGCGACGGAGGAGCTCCAGCAGCTGCGCGCAGACCTCCAGGCCGGCCTCCGGCGCCAGGATCCCGTACACGTAGTTCATTTTGCACAGGAAGCGCTCGATGTCGTTGAGTGTGGCCAGACTGACGCTGAAACGGACGTTGTCCGTAAACTGGAGCTCCACGGTGTGATGGCGATCGCAGCGATCCAAACGGAGGACGGTACGGTAGAAGGCCGCCCGGTCCGGCTGGCGCGAGTAGGCCATCAGCGCCCGATCCAGCAAAGCCGTATCCTCGTGCAGCGCCTTCAGCAGCATCTCCAGATAGAGAGTCAGCAGCGAACTCTGCGTACGATTCTGCGCCACCACCTCCGGGTAGATCTTCCGGTACAGATACACTATAGCCGCCGCGTTTCTCTTGAACGGCGTGGACTCCGCCAGTAACACGTTCGGATCGCAGTACTTTAGACACTCCAGCTCCATGGCGTATTCGTTGCATTTCGAACACACTACGCATAGTTTCTGTAACAAATTCATCTCCAT'
    elif (gene == 'cmvpol'):
        gene = 'TCAACAGCATTCGTGCGCCTTGACACTGTACGGCAGAAAAGCCGGCTCCAAGTGCAAGCGCCGCGGCAGCACCATGTGCAAAAACTTGTCCTTGCGCGCGGTTTCGCCGCCGGGAAAGACGGGCGACAGCACGTTGGTTACAGCCTTGAGAACCTGCTCAAAGTACTTGTCGGCGTGAATGGGCACGCCGTGCTCGCGCACGTAGCTCGGATCTTCGGCTACCTCGTAGTTGCACACGGCCGACGGTGGTTTCCGCGCCCTCTTCTTTGCCGGCTCTCCTCCTCTCCTGTTGCTCTCCTCTACCCCGCCGCCGTCAGCGTCGTCGTCCGTGCCATCAATCGCGTCCGACCGGGAAACCACGCCGGTGGTTACAGAATCACCGTTGTCGGAGGAACCCTGCGGCGCCGCCCGGACACCGGGCGCCGTCAGGACGTAAAAGACCCGATCCCCGACCGAGGGTAGCTCCTCAGAACGGGCCGCCAATCGCTTAATGACGGCAATGTGCGGCAGGTTAGATTGACGGTACAACGAGATGTCCTTAGAAAGCACCGACGAAAGCACCAGGTCCTCAACACGCACACGGTGCAGGTACAGATCGTCGCGGGCCTGCACCAGGCGGCGCAAGATACGCCAGAAACCGCGTGGCACACCGTATTTCTTAACTTCATCGAGTGAGAGGCGCGACAGGCGCACGGCTGCTTCCGAGACCTCGCGATCCTCAAAGAGCAGCGAGAGGACGTCACGCGTGACGCCCTTGACGAACTCGCAGGCCGTCTTGCGCACCAGATCCACGCCCTTCATGCTCAGACCCGAGGCGCCCTCCACTTTGCCGATGTAACGTTTCTTGCAGATCATCATAAGAGAGACGAAGACCTTTTCAAACTCCAGCTTGACGGGCTCCACAAAAAGACAAGCCGTCACGTAGTGCGCCAGGCTGGGCCCACGCGCCACCAGAGCCTGCGGCGTCAGGCCACGAAAGCGGACAAACACGCTGTCCGTGTCCCCGTAGATGACCCGCGCCTCCACCCGCCGTTCGTTTAAGCCCCCTGATGATGTTTCGAGCCCCTCCGGTAACGTGCTGCTCTCCTCCGAATCCCCCTCCCGCGTTCCTACTACATAGTCTTCCTGATTAAAAAAATTGTGCAAAAAACACGGCTCTGAAAAGTTGTCTTTGATGAACCGCGCCGTGCGCTCTAGCATGTCGCGACCGATGCGCGTAATGCTGGCGGCGATGGGCAGACACGGCATCATGCCGTTGACCACGCCGGTAAAACCGTAGAAAGCGTTGCACGTTACTTTGAGCGCCATCTGTTCCTTGTCGAGCAGCATACGGCGCACGGGGTCTTGACACTCGCGCATGCATTCGCGCACGGCACGCCGCTGCGAAACCCACTTGTTGAGCAGTTCCGAAAGCACCGAGACGCGCACCGAAGCACGCACAAAGCGGTGTGTCACGCCGTTCTCTAGCGTGACGCTGTATACGTCGGCAGGGTCCACGGGGTACTCGCCACCCGGCACCAGCAGGGTGGAGTAGCAGAGGTTGTGAGCCATGATGATGGAAGGGTAGAGGCTGGCAAAGTCGAACACGGCCACGGGGTCGTTGTAGTAACCCACCTCGGGCTCAAACACCGTGGCGCCCTGGTACGAAACCGCCGCAGTACCACCGGCGCCGTGATTGTCGTTGGAAACGCCGACGCCGCCACTACTGCCGGAGCCGACGCTGAAAACGCCGACGCTGCTACTACTGTTACTGCCGGAGCCGGGTGAAACGCCGTCCTGACTGGACGGCGCAGATTGCAAGGGCGGCGACATCTGAAACATAGCCGCCACAGAACCCGCGTCGCCGGGCACGGCGGCGGTAGAGATGATAGCGGCGTTAGGTGACACGGCAACACTATTCGTTTCGGGCACCGTCGTACCTTTGCTGTAGTGGTTGGGCAGGATAAAATCGCGGCAGGCGCACTCGTCCAGCAGCGAGGTGTAGATACGGATCTGCTGTCCGTCAAAGATGACACGCCGCAACGGAATTTTAGCCAGCCGCGCGATGGCCCCGGCCTCGTAGTGAAAATTAATGGTGTTGAACAGATCGCGCACCAATACGGCGTCCTGCAGACAGTAACGGCCTACCTGGGCGCGGCCCTCGGCATTAGCCACGAAACAACGCGGGATGTCCTTGTAGGACAGGTCATCCTTGCGTTGCCGCAGGTAAAGCTCGGCCATAGTGTTGAGCTTATAGTTGGGCGAGTTAGTCTTGGCCATGCATACGGGGTACATGTCGATAACCACCGAACCCGCAATATACACCTTGGTGGCGGCCGTGCTGGCCGGATTGTTGTGAGAAGCCGAGGGAAAGGCGGCGGCGTACTGCCGCTTAAAACCCACGGCGGGGCTGTGTAAAAAGAAACGGCCGCCCTGCGCCGTAGGCAACTTGCAGAAGCGCTGCGAGTCCACCTTATACAGGTACTCGAGGCGCGTGAGGATGTACTTCAAGTCAAAAGAGTTGATGTTGTAACCGGTCACAAAGGCCGGCGCGTACCGTTGAAAGAAAAGCATAAAGCCCAGCAGCAGCTCGTATTCGGAAGGGAACTCGTAGACGTCCACGTCTGGGCCCACCTGCCCGCAGGTGCCGATCGTGAAGAGATGAAGACCCGAGTGCCCAAAGATCACACCCTCCGAAGTGCAGCCCCGGCCATCGTTCCCGTTTGGGATCCCCTGATCCACGGCGGTGTTTCCCCCCGTCTCGTAGCACACGCACGAGATCTGAATGACAATGTCATCGGACTTCTCGGCGCAGGGAAAACCACCCTCGCCGCTCATGCACTCGATATCGAAGGACAGGCATCGATAGCGCGGCCACGAGCTGTCGTCGGGCACGGCCACCAGGTCAGAGACATCGCAGTCGACCTCGATATCACAAGTCGACGCGCGACCCTGCTGCCGCCAGTCGTAACGATTCACGGAGCACCAGCCGAACGTGGTGATCCGCCGATCGATGACCAAACGCGTCAGCGGATCCACACGGACCTCGTACACGGGAAAACCCTGCTCCAGCAGATACTCGCCGATTTTTCTGGCCATGGTCCAGTTGCTGATAGACACACACTGCAAATCGGGCACGGGTCGCGTCCCGTACCCGTAGATCGAGGTTTTGGTGGCCGGCGTGACAGACACGGCGTATGGCGTCCGCGGTTCGGGCACTAGTTCGCCCACGCTGGCAATGACCTCACGCAGCCTATCGGTGTCGCTGTACTCACAGTAAAAGTAGCTGCGCTGCCCGAAAACGTTGACGCAGATACTGTAGCCGTGTTCTGTGGCCCCGAAGAAACGCAACACGTTCCCCGAAGGCACCAGATGCTGACGATAGCGCGGCGACACGTTTTCGGGCGAGTCGAAGAAGAGCACGGCGTCCGTCTGATCGTAGGTGTGAAAACGAATAGGTCCCACCACGCGACCCACCAGGGTCTCGCGCCAAGGACACGGCCAAACCATGTCATGACTCAACAAATGTTTAATCTCTCGATAGAACATGAGAGGCAGCCGTCCCGTTTTATGCTTGATCAACCCCGTCTGACCGTCGAACATGACGCCTCGCGGCACGATCTGCAAAAACTGTTTCTGTGGCGGCCGCTTGCCCGAGCCCTGCGCGGAGCCGGGCTGCGAACGCTGACGCCGGCCACCCGCGACCGCACCGCCGGTCACGCCGCCGCTCAGATACGGGTTGAAAAACAT'
    elif (gene == 'hsv1tk'):
        gene = 'TTTATTCTGTCTTTTTATTGCCGTCATAGCGCGGGTTCCTTCCGGTATTGTCTCCTTCCGTGTTTCAGTTAGCCTCCCCCATCTCCCGGGCAAACGTGCGCGCCAGGTCGCAGATCGTCGGTATGGAGCCTGGGGTGGTGACGTGGGTCTGGACCATCCCGGAGGTAAGTTGCAGCAGGGCGTCCCGGCAGCCGGCGGGCGATTGGTCGTAATCCAGGATAAAGACGTGCATGGGACGGAGGCGTTTGGCCAAGACGTCCAAAGCCCAGGCAAACACGTTATACAGGTCGCCGTTGGGGGCCAGCAACTCGGGGGCCCGAAACAGGGTAAATAACGTGTCCCCGATATGGGGTCGTGGGCCCGCGTTGCTCTGGGGCTCGGCACCCTGGGGCGGCACGGCCGCCCCCGAAAGCTGTCCCCAATCCTCCCGCCACGACCCGCCGCCCTGCAGATACCGCACCGTATTGGCAAGCAGCCCATAAACGCGGCGAATCGCGGCCAGCATAGCCAGGTCAAGCCGCTCGCCGGGGCGCTGGCGTTTGGCCAGGCGGTCGATGTGTCTGTCCTCCGGAAGGGCCCCCAACACGATGTTTGTGCCGGGCAAGGTCGGCGGGATGAGGGCCACGAACGCCAGCACGGCCTGGGGGGTCATGCTGCCCATAAGGTATCGCGCGGCCGGGTAGCACAGGAGGGCGGCGATGGGATGGCGGTCGAAGATGAGGGTGAGGGCCGGGGGCGGGGCATGTGAGCTCCCAGCCTCCCCCCCGATATGAGGAGCCAGAACGGCGTCGGTCACGGCATAAGGCATGCCCATTGTTATCTGGGCGCTTGTCATTACCACCGCCGCGTCCCCGGCCGATATCTCACCCTGGTCGAGGCGGTGTTGTGTGGTGTAGATGTTCGCGATTGTCTCGGAAGCCCCCAACACCCGCCAGTAAGTCATCGGCTCGGGTACGTAGACGATATCGTCGCGCGAACCCAGGGCCACCAGCAGTTGCGTGGTGGTGGTTTTCCCCATCCCGTGGGGACCGTCTATATAAACCCGCAGTAGCGTGGGCATTTTCTGCTCCAGGCGGACTTCCGTGGCTTTTTGCTGCCGGCGAGGGCGCAACGCCGTACGTCGGTTGTTATGGCCGCGAGAACGCGCAGCCTGGTCGAACGCAGACGCGTGTTGATGGCAGGGGTACGAAGCCAT'
    elif (gene == 'hsv1pol'):
        gene = 'ATGTTTTCCGGTGGCGGCGGCCCGCTGTCCCCCGGAGGAAAGTCGGCGGCCAGGGCGGCGTCCGGGTTTTTTGCGCCCGCCGGCCCTCGCGGAGCCAGCCGGGGACCCCCGCCTTGTTTGAGGCAAAACTTTTACAACCCCTACCTCGCCCCAGTCGGGACGCAACAGAAGCCGACCGGGCCAACCCAGCGCCATACGTACTATAGCGAATGCGATGAATTTCGATTCATCGCCCCGCGGGTGCTGGACGAGGATGCCCCCCCGGAGAAGCGCGCCGGGGTGCACGACGGTCACCTCAAGCGCGCCCCCAAGGTGTACTGCGGGGGGGACGAGCGCGACGTCCTCCGCGTCGGGTCGGGCGGCTTCTGGCCGCGGCGCTCGCGCCTGTGGGGCGGCGTGGACCACGCCCCGGCGGGGTTCAACCCCACCGTCACCGTCTTTCACGTGTACGACATCCTGGAGAACGTGGAGCACGCGTACGGCATGCGCGCGGCCCAGTTCCACGCGCGGTTTATGGACGCCATCACACCGACGGGGACCGTCATCACGCTCCTGGGCCTGACTCCGGAAGGCCACCGGGTGGCCGTTCACGTTTACGGCACGCGGCAGTACTTTTACATGAACAAGGAGGAGGTCGACAGGCACCTACAATGCCGCGCCCCACGAGATCTCTGCGAGCGCATGGCCGCGGCCCTGCGCGAGTCCCCGGGCGCGTCGTTCCGCGGCATCTCCGCGGACCACTTCGAGGCGGAGGTGGTGGAGCGCACCGACGTGTACTACTACGAGACGCGCCCCGCTCTGTTTTACCGCGTCTACGTCCGAAGCGGGCGCGTGCTGTCGTACCTGTGCGACAACTTCTGCCCGGCCATCAAGAAGTACGAGGGTGGGGTCGACGCCACCACCCGGTTCATCCTGGACAACCCCGGGTTCGTCACCTTCGGCTGGTACCGTCTCAAACCGGGCCGGAACAACACGCTAGCCCAGCCGCGGGCCCCGATGGCCTTCGGGACATCCAGCGACGTCGAGTTTAACTGTACGGCGGACAACCTGGCCATCGAGGGGGGCATGAGCGACCTACCGGCATACAAGCTCATGTGCTTCGATATCGAATGCAAGGCGGGGGGGGAGGACGAGCTGGCCTTTCCGGTGGCCGGGCACCCGGAGGACCTGGTCATCCAGATATCCTGTCTGCTCTACGACCTGTCCACCACCGCCCTGGAGCACGTCCTCCTGTTTTCGCTCGGTTCCTGCGACCTCCCCGAATCCCACCTGAACGAGCTGGCGGCCAGGGGCCTGCCCACGCCCGTGGTTCTGGAATTCGACAGCGAATTCGAGATGCTGTTGGCCTTCATGACCCTTGTGAAACAGTACGGCCCCGAGTTCGTGACCGGGTACAACATCATCAACTTCGACTGGCCCTTCTTGCTGGCCAAGCTGACGGACATTTACAAGGTCCCCCTGGACGGGTACGGCCGCATGAACGGCCGGGGCGTGTTTCGCGTGTGGGACATAGGCCAGAGCCACTTCCAGAAGCGCAGCAAGATAAAGGTGAACGGCATGGTGAACATCGACATGTACGGGATTATAACCGACAAGATCAAGCTCTCGAGCTACAAGCTCAACGCCGTGGCCGAAGCCGTCCTGAAGGACAAGAAGAAGGACCTGAGCTATCGCGACATCCCCGCCTACTACGCCGCCGGGCCCGCGCAACGCGGGGTGATCGGCGAGTACTGCATACAGGATTCCCTGCTGGTGGGCCAGCTGTTTTTTAAGTTTTTGCCCCATCTGGAGCTCTCGGCCGTCGCGCGCTTGGCGGGTATTAACATCACCCGCACCATCTACGACGGCCAGCAGATCCGCGTCTTTACGTGCCTGCTGCGCCTGGCCGACCAGAAGGGCTTTATTCTGCCGGACACCCAGGGGCGATTTAGGGGCGCCGGGGGGGAGGCGCCCAAGCGTCCGGCCGCAGCCCGGGAGGACGAGGAGCGGCCAGAGGAGGAGGGGGAGGACGAGGACGAACGCGAGGAGGGCGGGGGCGAGCGGGAGCCGGAGGGCGCGCGGGAGACCGCCGGCAGGCACGTGGGGTACCAGGGGGCCAGGGTCCTTGACCCCACTTCCGGGTTTCACGTGAACCCCGTGGTGGTGTTCGACTTTGCCAGCCTGTACCCCAGCATCATCCAGGCCCACAACCTGTGCTTCAGCACGCTCTCCCTGAGGGCCGACGCAGTGGCGCACCTGGAGGCGGGCAAGGACTACCTGGAGATCGAGGTGGGGGGGCGACGGCTGTTCTTCGTCAAGGCTCACGTGCGAGAGAGCCTCCTCAGCATCCTCCTGCGGGACTGGCTCGCCATGCGAAAGCAGATCCGCTCGCGGATTCCCCAGAGCAGCCCCGAGGAGGCCGTGCTCCTGGACAAGCAGCAGGCCGCCATCAAGGTCGTGTGTAACTCGGTGTACGGGTTCACGGGAGTGCAGCACGGACTCCTGCCGTGCCTGCACGTTGCCGCGACGGTGACGACCATCGGCCGCGAGATGCTGCTCGCGACCCGCGAGTACGTCCACGCGCGCTGGGCGGCCTTCGAACAGCTCCTGGCCGATTTCCCGGAGGCGGCCGACATGCGCGCCCCCGGGCCCTATTCCATGCGCATCATCTACGGGGACACGGACTCCATCTTTGTGCTGTGCCGCGGCCTCACGGCCGCCGGGCTGACGGCCGTGGGCGACAAGATGGCGAGCCACATCTCGCGCGCGCTGTTTCTGCCCCCCATCAAACTCGAGTGCGAAAAGACGTTCACCAAGCTGCTGCTGATCGCCAAGAAAAAGTACATCGGCGTCATCTACGGGGGTAAGATGCTCATCAAGGGCGTGGATCTGGTGCGCAAAAACAACTGCGCGTTTATCAACCGCACCTCCAGGGCCCTGGTCGACCTGCTGTTTTACGACGATACCGTCTCCGGAGCGGCCGCCGCGTTAGCCGAGCGCCCCGCGGAGGAGTGGCTGGCGCGACCCCTGCCCGAGGGACTGCAGGCGTTCGGGGCCGTCCTCGTAGACGCCCATCGGCGCATCACCGACCCGGAGAGGGACATCCAGGACTTTGTCCTCACCGCCGAACTGAGCAGACACCCGCGCGCGTACACCAACAAGCGCCTGGCCCACCTGACGGTGTATTACAAGCTCATGGCCCGCCGCGCGCAGGTCCCGTCCATCAAGGACCGGATCCCGTACGTGATCGTGGCCCAGACCCGCGAGGTAGAGGAGACGGTCGCGCGGCTGGCCGCCCTCCGCGAGCTAGACGCCGCCGCCCCAGGGGACGAGCCCGCCCCCCCCGCGGCCCTGCCCTCCCCGGCCAAGCGCCCCCGGGAGACGCCGTCGCCTGCCGACCCCCCGGGAGGCGCGTCCAAGCCCCGCAAGCTGCTGGTGTCCGAGCTGGCCGAGGATCCCGCATACGCCATTGCCCACGGCGTCGCCCTGAACACGGACTATTACTTCTCCCACCTGTTGGGGGCGGCGTGCGTGACATTCAAGGCCCTGTTTGGGAATAACGCCAAGATCACCGAGAGTCTGTTAAAAAGGTTTATTCCCGAAGTGTGGCACCCCCCGGACGACGTGGCCGCGCGGCTCCGGACCGCAGGGTTCGGGGCGGTGGGTGCCGGCGCTACGGCGGAGGAAACTCGTCGAATGTTGCATAGAGCCTTTGATACTCTAGCATGAGCCCCCCGTCGAAGCTGATGTCCCTCATTTTACAATAAA'
    elif (gene == 'hsv2tk'):
        gene = 'TTTATTCTGTTCTTTTATTGCCGTCATCGCCGGGAGGCCTTCCGTTCGGGCTTCCGTGTTTGAACTAAACTCCCCCCACCTCGCGGGCAAACGTGCGCGCCAGGTCGCGTATCTCGGCGATGGACCCGGCGGTTGTGACGCGGGTTGGGATCATCCCGGCGGTGAGGCGCAACAGGGCGTCTCGACACCCGACGGGCGACTGATCGTAATCCAGGACAAATAGATGCATCGGAAGGAGGCGGTCGGCCAAGACGTCCAAGACCCAGGCAAAAATGTGGTACAAGTCCCCGTTGGGGGCCAGCAGCTCGGGAACGCGGAACAGGGCAAACAGCGTGTCCTCGATGCGGGGCAGAGACCCCGCGCCGTCCTCGGGGTCGGGGCGCGGGGTCGCCGCGGCGACCCCCGTCAGCCGGCCCCAGTCCTCCCGCCACCTCCCGCCGCGCTGCAGGTACCGCACCGTGTTGGCGAGTAGATCGTAGACACGGCGAATGGCGGACAGCATGGCCAGGTCAAGCCGCTCGCCCGGGCGTTGGCGTCTGGCCAGGCGGTCGGCGTGTTCGGCCTCCGGAAGGACACCCAGGACCAGGTTCGTGCCGGGCGCGGTCGGGGGCATGAGGGCCACGAACGCCAACACGGCCTGGGGGGTCATGCTTCCCATGAGGTACCGCGCGGCCGGGTAGCACAGCAGGGAGGCGATAGGGTGCCGGTCGAAAACAAGGGTGAGGGCCGGGGGCGGGGCTTGCGGGCCCACAGCCTCCCCCCCGATATGAGGAGCCAAAACGGCGTCCGTCGCCGCATAAGGCGTGCTCATTGTTATCTGGGCGCTGGTCATTACCACCGCCGCCTCCCCGGCCGATATCTCGCCGCGGTCCAGACGGTGCTGCGTGTTGTAGATGTTCGTCAGGGTCTCGGAGGCCCCCAGCACCTGCCAGTAAGTCATCGGCTCGGGGACGTAGACGATATTGTCGCGCGGCCCCAGGGCCTCCATCAGCTGCGCGGAGGTGGTGGTCTTCCCCACCCCGTGGGGTCCGTCTATATAAACCCGCAGCAGCGTGGGCAGCTCCGGATCCCCGCGGGCTCCGGAGGCCCCCTGGCGATGGCTAGGACGGGACGCCGCGCGGCCGTCGGTAGGCCCGCTCGCACGAGCAGCCTGACCGAACGCAGGCGCGTGCTGTTGGCCGGCGTGAGAAGCCAT'
    elif (gene == 'hsv2pol'):
        gene = 'ATGTTTTGTGCCGCGGGCGGCCCGGCTTCCCCCGGGGGGAAGCCGGCGGCTCGGGCGGCGTCTGGGTTTTTTGCCCCCCACAACCCCCGGGGAGCCACCCAGACGGCACCGCCGCCTTGCCGCCGGCAGAACTTCTACAACCCCCACCTCGCTCAGACCGGAACGCAGCCAAAGGCCCTCGGGCCGGCTCAGCGCCATACGTACTACAGCGAGTGCGACGAATTTCGATTTATCGCCCCGCGTTCGCTGGACGAGGACGCCCCCGCGGAGCAGCGCACCGGGGTCCACGACGGCCGCCTCCGGCGCGCCCCTAAGGTGTACTGCGGGGGGGACGAGCGCGACGTCCTCCGCGTGGGCCCGGAGGGCTTCTGGCCGCGTCGCTTGCGCCTGTGGGGCGGTGCGGACCATGCCCCCGAGGGGTTCGACCCCACCGTCACCGTCTTCCACGTGTACGACATCCTGGAGCACGTGGAACACGCGTACAGCATGCGCGCCGCCCAGCTCCACGAGCGATTTATGGACGCCATCACGCCCGCCGGGACCGTCATCACGCTTCTGGGTCTGACCCCCGAAGGCCATCGCGTCGCCGTTCACGTCTACGGCACGCGGCAGTACTTTTACATGAACAAGGCGGAGGTGGATCGGCACCTGCAGTGCCGTGCCCCGCGCGATCTCTGCGAGCGCCTGGCGGCGGCCCTGCGCGAGTCGCCGGGGGCGTCGTTCCGCGGCATCTCCGCGGACCACTTCGAGGCGGAGGTGGTGGAGCGCGCCGACGTGTACTATTACGAAACGCGCCCGACCCTGTACTACCGCGTCTTCGTGCGAAGCGGGCGCGCGCTGGCCTACCTGTGCGACAACTTTTGCCCCGCGATCAGGAAGTACGAGGGGGGCGTCGACGCCACCACCCGGTTTATCCTGGACAACCCGGGGTTTGTCACCTTCGGCTGGTACCGCCTCAAGCCCGGCCGCGGGAACGCGCCGGCCCAACCGCGCCCCCCGACGGCGTTCGGAACCTCGAGCGACGTCGAGTTTAACTGCACGGCGGACAACCTGGCCGTCGAGGGGGCCATGTGTGACCTGCCGGCCTACAAGCTCATGTGCTTCGATATCGAATGCAAGGCCGGGGGGGAGGACGAGCTGGCCTTTCCGGTCGCGGAACGCCCGGAAGACCTCGTCATCCAGATCTCCTGTCTGCTCTACGACCTGTCCACCACCGCCCTCGAGCACATCCTCCTGTTTTCGCTCGGATCCTGCGACCTCCCCGAGTCCCACCTCAGCGATCTCGCCTCCAGGGGCCTGCCGGCCCCCGTCGTCCTGGAGTTTGACAGCGAATTCGAGATGCTGCTGGCCTTCATGACCTTCGTCAAGCAGTACGGCCCCGAGTTCGTGACCGGGTACAACATCATCAACTTCGACTGGCCCTTCGTCCTGACCAAGCTGACGGAGATCTACAAGGTCCCGCTCGACGGGTACGGGCGCATGAACGGCCGGGGTGTGTTCCGCGTGTGGGACATCGGCCAGAGCCACTTTCAGAAGCGCAGCAAGATCAAGGTGAACGGGATGGTGAACATCGACATGTACGGCATCATCACCGACAAGGTCAAACTCTCCAGCTACAAGCTGAACGCCGTCGCCGAGGCCGTCTTGAAGGACAAGAAGAAGGATCTGAGCTACCGCGACATCCCCGCCTACTACGCCTCCGGGCCCGCGCAGCGCGGGGTGATCGGCGAGTATTGTGTGCAGGACTCGCTGCTGGTCGGGCAGCTGTTCTTCAAGTTTCTGCCGCACCTGGAGCTTTCCGCCGTCGCGCGCCTGGCGGGCATCAACATCACCCGCACCATCTACGACGGCCAGCAGATCCGCGTCTTCACGTGCCTCCTGCGCCTTGCGGGCCAGAAGGGCTTCATCCTGCCGGACACCCAGGGGCGGTTTCGGGGCCTCGACAAGGAGGCGCCCAAGCGCCCGGCCGTGCCTCGGGGGGAAGGGGAGCGGCCGGGGGACGGGAACGGGGACGAGGATAAGGACGACGACGAGGACGGGGACGAGGACGGGGACGAGCGCGAGGAGGTCGCGCGCGAGACCGGGGGCCGGCACGTTGGGTACCAGGGGGCCCGGGTCCTCGACCCCACCTCCGGGTTTCACGTCGACCCCGTGGTGGTGTTTGACTTTGCCAGCCTGTACCCCAGCATCATCCAGGCCCACAACCTGTGCTTCAGTACGCTCTCCCTGCGGCCCGAGGCCGTCGCGCACCTGGAGGCGGACCGGGACTACCTGGAGATCGAGGTGGGGGGCCGACGGCTGTTCTTCGTGAAGGCCCACGTACGCGAGAGCCTGCTGAGCATCCTGCTGCGCGACTGGCTGGCCATGCGAAAGCAGATCCGCTCGCGGATCCCCCAGAGCACCCCCGAGGAGGCCGTCCTCCTCGACAAGCAACAGGCCGCCATCAAGGTGGTGTGCAACTCGGTGTACGGGTTCACCGGGGTGCAGCACGGTCTTCTGCCCTGCCTGCACGTGGCCGCCACCGTGACGACCATCGGCCGCGAGATGCTCCTCGCGACGCGCGCGTACGTGCACGCGCGCTGGGCGGAGTTCGATCAGCTGCTGGCCGACTTTCCGGAGGCGGCCGGCATGCGCGCCCCCGGTCCGTACTCCATGCGCATCATCTACGGGGACACGGACTCCATTTTCGTTTTGTGCCGCGGCCTCACGGCCGCGGGCCTGGTGGCCATGGGCGACAAGATGGCGAGCCACATCTCGCGCGCGCTGTTCCTCCCCCCGATCAAGCTCGAGTGCGAAAAAACGTTCACCAAGCTGCTGCTCATCGCCAAGAAAAAGTACATCGGCGTCATCTGCGGGGGCAAGATGCTCATCAAGGGCGTGGATCTGGTGCGCAAAAACAACTGCGCGTTTATCAACCGCACCTCCAGGGCCCTGGTCGACCTGCTGTTTTACGACGATACCGTATCCGGAGCGGCCGCCGCGTTAGCCGAGCGCCCCGCAGAGGAGTGGCTGGCGCGACCCCTGCCCGAGGGACTGCAGGCGTTCGGGGCCGTCCTCGTAGACGCCCATCGGCGCATCACCGACCCGGAGAGGGACATCCAGGACTTTGTCCTCACCGCCGAACTGAGCAGACACCCGCGCGCGTACACCAACAAGCGCCTGGCCCACCTGACGGTGTATTACAAGCTCATGGCCCGCCGCGCGCAGGTCCCGTCCATCAAGGACCGGATCCCGTACGTGATCGTGGCCCAGACCCGCGAGGTAGAGGAGACGGTCGCGCGGCTGGCCGCCCTCCGCGAGCTAGACGCCGCCGCCCCAGGGGACGAGCCCGCCCCCCCAGCGGCCCTGCCCTCCCCGGCCAAGCGCCCCCGGGAGACGCCGTCGCATGCCGACCCCCCGGGAGGCGCGTCCAAGCCCCGCAAGCTGCTGGTGTCCGAGCTGGCGGAGGATCCCGGGTACGCCATCGCCCGGGGCGTTCCGCTCAACACGGACTATTACTTCTCGCACCTGCTGGGGGCGGCCTGCGTGACGTTCAAGGCCCTGTTTGGAAATAACGCCAAGATCACCGAGAGTCTGTTAAAGAGGTTTATTCCCGAGACGTGGCACCCCCCGGACGACGTGGCCGCGCGGCTCAGGGCCGCGGGGTTCGGGCCGGCGGGGGCCGGCGCTACGGCGGAGGAAACTCGTCGAATGTTGCATAGAGCCTTTGATACTCTAGCATGAGCCCCCCGTCGAAGCTGATGTCCCGCATCTTGCAATAAA'
    else:
        return {
            'statusCode': 400
        }
    q = format(record.seq)
    alignments = pairwise2.align.globalms(q, gene, 2, -1, -6, -5)
    sequence = alignments[0][0]
    sequence = sequence.replace('-', 'n')
    my_seq = Seq(sequence)
    function_output = str(my_seq.translate())
    print(function_output)
    txt = open(upload_path, "w")
    txt.write(function_output)
    txt.close()
    return {
        'statusCode': 200
    }
